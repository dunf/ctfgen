heat_template_version: 2015-10-15

description: >
  HOT template that invokes subtemplates
parameters:
  key_name:
    type: string
    description: Name of keypair to assign to servers
  image_linux:
    type: string
    description: Name of image to use for GNU/Linux servers
    default: Ubuntu Server 18.04 LTS (Bionic Beaver) amd64
  sec_group_linux:
    type: comma_delimited_list
    description: Security groups
    default: FooRules,default
  public_net:
    type: string
    description: >
      ID or name of public network for which floating IP addresses will be allocated
    default: ntnu-internal
  group_id:
    type: string
    description: 2 digit ID assigned to each group.

resources:

  networking:
    type: LL_tier2_networking.yaml
    properties:
      id: { get_param: }

  
  linux_01:
    type: LL_tier2_linux_server.yaml
    depends_on: networking
    properties:
      server_name:       "linux01"
      key_name:          { get_param: key_name }
      public_net:        { get_param: public_net }
      group_net_name:    { get_attr: [networking, group_name] }
      image_linux:       { get_param: image_linux }    
      sec_group_linux:   { get_param: sec_group_linux }  
      lan_subnet:        { get_attr: [networking, lan_subnet] } 
     # dmz_subnet:        {Â get_attr: [networking, dmz_subnet, name] }


